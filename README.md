# 神港学園高等学校 合格者お知らせサイト

## 📋 プロジェクト概要

神港学園高等学校の合格者向け情報管理システムです。管理者がお知らせ、書類、合格証書、入学手続金情報などを管理し、合格者がログインして必要な情報を確認できるWebアプリケーションです。

## ✨ 主要機能

### 🎯 管理者機能

#### 📢 お知らせ管理
- **お知らせの作成・編集・削除**
- **個別お知らせ機能**: 特定の学生向けのお知らせ管理
- **即座公開**: 作成時に即座に学生に公開

#### 📊 個人結果管理
- **Excelファイルアップロード**: 受験結果データの一括登録
- **個別編集・削除**: 受験結果の詳細編集
- **検索・フィルター機能**: 受験番号、氏名、合格状況での絞り込み
- **CSV/Excel出力**: データのエクスポート機能
- **合格状況表示**: 合格/不合格/廻し合格の自動判定
- **不合格者対応**: 不合格者の場合「情報がありません」表示

#### 🔐 ログイン設定管理
- **CSVファイルアップロード**: 学生アカウントの一括作成
- **受験番号・パスワード管理**: 4桁の受験番号と電話番号下4桁
- **カスタムユーザー追加**: 手動での個別ユーザー作成
- **ユーザー削除機能**: 個別削除・全学生削除
- **学生一覧表示**: 検索・ソート機能付き

#### 📝 学生プロフィール管理
- **動的フォーム生成**: 管理画面での設定変更が学生フォームに即座反映
- **多段階フォーム**: 個人情報、通学方法、芸術科目、健康情報
- **進捗状況管理**: 各セクションの完了状況を追跡
- **CSV/Excel出力**: プロフィールデータのエクスポート
- **カスタムフォーム設定**: 管理者によるフォーム項目のカスタマイズ
- **必須フィールドバリデーション**: 動的なバリデーション設定

#### ⚙️ フォーム設定管理
- **カスタムフィールド**: プロフィールフォームの項目追加・編集・削除
- **フィールド設定**: 必須項目、表示/非表示、バリデーション設定
- **動的反映**: 設定変更が学生フォームに即座反映
- **フィールド順序**: 表示順序のカスタマイズ
- **フィールドタイプ**: テキスト、メール、電話番号、日付、セレクト、テキストエリア、チェックボックス、ラジオボタン

#### 💰 入学手続金お知らせ管理
- **料金設定**: 入学金、諸費、学年費の一部の金額設定
- **振込期日設定**: 専願者・併願者別の振込期日管理
- **免除設定**: カスタム免除項目の作成・編集
- **学生割り当て**: 特定の学生への免除割り当て
- **注意事項編集**: 管理画面からの注意事項編集
- **不合格者対応**: 不合格者の場合「情報がありません」表示

#### 📄 書類管理
- **PDFファイルアップロード**: 各種書類の管理
- **学生向けダウンロード**: 合格者が書類をダウンロード

#### 🏆 合格証書管理
- **合格証書アップロード**: 学生IDと紐付けた証書管理
- **個別表示**: 学生が自分の合格証書を確認

### 🎓 学生機能

#### 📱 レスポンシブデザイン
- **モバイル最適化**: スマートフォンでの快適な操作
- **ハンバーガーメニュー**: モバイル用のナビゲーション
- **タブレット対応**: 中画面デバイスでの最適表示

#### 📢 お知らせ閲覧
- **公開済みお知らせ**: 管理者が公開したお知らせのみ表示
- **個別お知らせ**: 自分専用のお知らせ表示
- **リアルタイム更新**: 新しいお知らせの即座反映

#### 📊 個人結果確認
- **個別お知らせ**: 自分の受験結果を確認
- **合格状況表示**: 合格/不合格/廻し合格の詳細表示
- **コース情報**: 出願コースと合格コースの比較

#### 💰 入学手続金お知らせ
- **料金内訳表示**: 入学金、諸費、学年費の一部の詳細表示
- **振込期日表示**: 専願者・併願者別の振込期日
- **免除適用**: 割り当てられた免除の自動適用
- **注意事項表示**: 管理者が設定した注意事項

#### 📄 書類ダウンロード
- **各種書類**: 管理者がアップロードした書類のダウンロード
- **合格証書**: 自分の合格証書の確認・ダウンロード

#### 👤 プロフィール管理
- **動的フォーム**: 管理画面での設定変更が即座反映
- **多段階入力**: 4つのセクションに分かれた詳細な情報入力
- **一時保存**: 各セクションごとの保存機能
- **進捗表示**: 入力完了状況の視覚的表示
- **バリデーション**: 必須フィールドの動的バリデーション

## 🛠️ 技術スタック

### フロントエンド
- **Next.js 15**: React 19ベースのフルスタックフレームワーク
- **TypeScript**: 型安全性の確保
- **Tailwind CSS**: モダンなスタイリング
- **レスポンシブデザイン**: モバイルファーストアプローチ

### バックエンド
- **Vercel Serverless Functions**: API Routes
- **Vercel Postgres**: データベース
- **Vercel Blob**: ファイルストレージ

### 認証・セキュリティ
- **SHA-256**: パスワードハッシュ化
- **セッション管理**: 安全なログイン状態管理
- **API分離**: 管理者・学生向けエンドポイントの分離

## 🚀 セットアップ

### 前提条件
- Node.js 18以上
- npm または yarn
- Vercelアカウント
- GitHubアカウント

### 1. リポジトリのクローン
```bash
git clone https://github.com/tegujupe222/shinkogakuen.git
cd shinkogakuen
```

### 2. 依存関係のインストール
```bash
npm install
```

### 3. 環境変数の設定
`.env.local`ファイルを作成し、以下の環境変数を設定：

```env
# Vercel Postgres
POSTGRES_URL=your_postgres_connection_string

# Vercel Blob (オプション)
BLOB_READ_WRITE_TOKEN=your_blob_token
```

### 4. 開発サーバーの起動
```bash
npm run dev
```

### 5. データベースの初期化
開発サーバー起動後、以下のエンドポイントにアクセスしてデータベースを初期化：

```
POST /api/init
POST /api/migrate
```

## 📦 デプロイ

### Vercelへのデプロイ

1. **Vercelプロジェクトの作成**
   - Vercelダッシュボードで新しいプロジェクトを作成
   - GitHubリポジトリと連携

2. **環境変数の設定**
   - Vercelダッシュボードで環境変数を設定
   - `POSTGRES_URL`: Vercel Postgresの接続文字列

3. **データベースの設定**
   - Vercel Postgresをプロジェクトに追加
   - データベース作成後、`/api/init`エンドポイントにアクセス

4. **自動デプロイ**
   - GitHubにプッシュすると自動的にデプロイ

## 🔧 使用方法

### 管理者ログイン
- **受験番号**: `9999`
- **パスワード**: `5896`

### 学生ログイン
- **受験番号**: CSVアップロードで設定された4桁の番号
- **パスワード**: 電話番号の下4桁

### 管理者操作フロー

1. **ログイン設定**
   - ログイン設定タブでCSVアップロードまたは手動追加
   - 学生アカウントの作成・管理

2. **お知らせ作成**
   - お知らせ管理タブで新規作成
   - 個別お知らせの設定
   - 保存して学生に公開

3. **個人結果登録**
   - 個人結果管理タブでExcelアップロード
   - 受験結果データを一括登録

4. **フォーム設定**
   - フォーム設定タブでカスタムフィールドの追加・編集
   - 必須項目、表示順序、バリデーションの設定

5. **入学手続金設定**
   - 入学手続金お知らせタブで料金・期日・免除の設定
   - 学生への免除割り当て

6. **書類管理**
   - 書類管理タブでPDFファイルをアップロード
   - 学生がダウンロード可能

### 学生操作フロー

1. **ログイン**
   - 受験番号とパスワードでログイン

2. **お知らせ確認**
   - 公開済みのお知らせと個別お知らせを確認

3. **個人結果確認**
   - 自分の受験結果を確認

4. **入学手続金確認**
   - 料金内訳、振込期日、免除情報を確認

5. **プロフィール入力**
   - 動的に生成されるフォームで詳細情報を入力
   - 各セクションごとに保存

## 📁 プロジェクト構造

```
合格者お知らせサイト/
├── app/                          # Next.js App Router
│   ├── api/                      # API Routes
│   │   ├── admission-fee-exemptions/     # 入学手続金免除API
│   │   ├── admission-fee-settings/       # 入学手続金設定API
│   │   ├── announcements/        # お知らせAPI
│   │   ├── auth/                 # 認証API
│   │   ├── form-settings/        # フォーム設定API
│   │   ├── results/              # 個人結果API
│   │   ├── student-exemption-assignments/ # 学生免除割り当てAPI
│   │   ├── upload-login-settings/ # ログイン設定アップロードAPI
│   │   └── ...
│   └── page.tsx                  # メインページ
├── components/                   # Reactコンポーネント
│   ├── admin/                    # 管理者用コンポーネント
│   │   ├── AdminAdmissionFees.tsx    # 入学手続金管理
│   │   ├── AdminFormSettings.tsx     # フォーム設定管理
│   │   ├── AdminLoginSettings.tsx    # ログイン設定管理
│   │   └── ...
│   ├── student/                  # 学生用コンポーネント
│   │   ├── AdmissionFeeView.tsx     # 入学手続金表示
│   │   ├── ProfileFormView.tsx      # 動的プロフィールフォーム
│   │   └── ...
│   ├── shared/                   # 共通コンポーネント
│   └── icons/                    # アイコンコンポーネント
├── lib/                          # ユーティリティ
│   └── db.ts                     # データベース関数
├── hooks/                        # カスタムフック
├── types.ts                      # TypeScript型定義
└── README.md                     # このファイル
```

## 🔒 セキュリティ機能

- **パスワードハッシュ化**: SHA-256による安全なパスワード管理
- **API分離**: 管理者・学生向けエンドポイントの完全分離
- **データフィルタリング**: 学生には公開済みデータのみ表示
- **入力検証**: フロントエンド・バックエンド両方でのバリデーション

## 📱 レスポンシブ対応

- **モバイルファースト**: スマートフォンでの最適な表示
- **ハンバーガーメニュー**: モバイル用ナビゲーション
- **タブレット対応**: 中画面デバイスでの最適化
- **デスクトップ対応**: 大画面での快適な操作

## 🎯 主要技術的改善

### 動的フォーム生成システム
- **すべてのセクションを動的化**: 個人情報、通学方法、芸術科目、健康情報
- **管理画面での変更が学生フォームに完全反映**
- **大幅なコード削減**: 357行削除、58行追加
- **ハードコードされた重複フィールドを除去**

### データベース設計
- **form_settings**: 動的フォーム設定テーブル
- **admission_fee_settings**: 入学手続金設定テーブル
- **admission_fee_exemptions**: 免除項目テーブル
- **student_exemption_assignments**: 学生免除割り当てテーブル

## 🚀 今後の拡張予定

- **プッシュ通知**: 新しいお知らせの通知機能
- **ファイル管理**: より高度なファイル管理機能
- **レポート機能**: データ分析・レポート生成
- **多言語対応**: 国際化対応

## 📞 サポート

技術的な問題や機能の要望については、GitHubのIssuesページでお知らせください。

## 📄 ライセンス

このプロジェクトは神港学園高等学校専用のシステムです。

---

**開発者**: AI Assistant  
**最終更新**: 2025年8月23日  
**バージョン**: 2.0.0
